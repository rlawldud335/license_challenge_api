export const getAllChallenge = "SELECT challenge.challengeId, challenge.challengeTitle, NULL as licenseName,  challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit, challengeCreateDt FROM challenge WHERE challenge.licenseId IS NULL UNION SELECT challenge.challengeId, challenge.challengeTitle, license.licenseName, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit, challengeCreateDt FROM challenge, license WHERE challenge.licenseId=license.licenseId ORDER BY challengeCreateDt DESC LIMIT "
export const getLicenseChallenges = "SELECT challenge.challengeId, challenge.challengeTitle, license.licenseName, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit FROM challenge, license WHERE challenge.licenseId=license.licenseId AND challengeCategory = '자격증' ORDER BY challengeCreateDt DESC LIMIT "
export const getOtherChallenges = "SELECT challenge.challengeId, challenge.challengeTitle, NULL as licenseName,  challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit, challengeCreateDt FROM challenge WHERE challenge.licenseId IS NULL AND challengeCategory = ? ORDER BY challengeCreateDt DESC LIMIT "
export const getOneChallenge = "SELECT challenge.*, license.licenseName, user.nickname AS 'leaderName', user.profileImage AS 'leaderProfileImage' FROM challenge, license, user WHERE challengeId=? AND challenge.leaderId=user.userId AND challenge.licenseId=license.licenseId UNION SELECT challenge.*, NULL AS licenseName, user.nickname AS 'leaderName', user.profileImage AS 'leaderProfileImage' FROM challenge, user WHERE challengeId=? AND challenge.leaderId=user.userId"
export const createLicenseChallenge = "INSERT INTO license_challenge.challenge (challengeTitle, challengeCategory, licenseId, leaderId, proofMethod, proofAvailableDay, proofCount, proofCountOneDay, chgStartDt, chgEndDt, challengeTitleImage, challengeIntroduction, goodProofImage, badProofImage, deposit, limitPeople, joinPeople) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,1);"
export const createOtherChallenge = "INSERT INTO license_challenge.challenge (challengeTitle, challengeCategory, leaderId, proofMethod, proofAvailableDay, proofCount, proofCountOneDay, chgStartDt, chgEndDt, challengeTitleImage, challengeIntroduction, goodProofImage, badProofImage, deposit, limitPeople, joinPeople) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,1);"
export const updateChallenge = "UPDATE challenge SET challengeTitle= ?, proofMethod = ?, proofAvailableDay = ?, proofCount = ?, proofCountOneDay = ?, challengeTitleImage = ?, challengeIntroduction = ?, goodProofImage= ?, badProofImage = ?, limitPeople= ? WHERE challengeId = ?"
export const deleteChallenge = "DELETE FROM license_challenge.challenge WHERE challengeId = ?;"
export const getOngoingChallenge = "SELECT challenge.challengeId, challenge.challengeTitle, license.licenseName, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit , challenge.chgStartDt,  challenge.chgEndDt, challenge.challengeCreateDt, IFNULL(ROUND((join_challenge.successCnt/(join_challenge.successCnt+join_challenge.failCnt))*100),0) AS achievement_rate FROM challenge, license, join_challenge WHERE challenge.licenseId=license.licenseId AND join_challenge.challengeId = challenge.challengeId AND join_challenge.userId=? AND challenge.chgEndDt >= date(now()) UNION SELECT challenge.challengeId, challenge.challengeTitle, NULL AS licenseName, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit , challenge.chgStartDt,  challenge.chgEndDt, challenge.challengeCreateDt, IFNULL(ROUND((join_challenge.successCnt/(join_challenge.successCnt+join_challenge.failCnt))*100),0) FROM challenge, license, join_challenge WHERE challenge.licenseId IS NULL AND join_challenge.challengeId = challenge.challengeId AND join_challenge.userId=? AND challenge.chgEndDt >= date(now()) ORDER BY challengeCreateDt DESC"
export const getEndedChallenge = "SELECT challenge.challengeId, challenge.challengeTitle, license.licenseName, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit , challenge.chgStartDt,  challenge.chgEndDt, challenge.challengeCreateDt, IFNULL(ROUND((join_challenge.successCnt/(join_challenge.successCnt+join_challenge.failCnt))*100),0) AS achievement_rate FROM challenge, license, join_challenge WHERE challenge.licenseId=license.licenseId AND join_challenge.challengeId = challenge.challengeId AND join_challenge.userId=? AND challenge.chgEndDt < date(now()) UNION SELECT challenge.challengeId, challenge.challengeTitle, NULL AS licenseName, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit , challenge.chgStartDt,  challenge.chgEndDt, challenge.challengeCreateDt, IFNULL(ROUND((join_challenge.successCnt/(join_challenge.successCnt+join_challenge.failCnt))*100),0) FROM challenge, license, join_challenge WHERE challenge.licenseId IS NULL AND join_challenge.challengeId = challenge.challengeId AND join_challenge.userId=? AND challenge.chgEndDt < date(now()) ORDER BY challengeCreateDt DESC"
export const searchChallenge = "SELECT challenge.challengeId, challenge.challengeTitle, NULL as licenseName,  challenge.challengeIntroduction, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit , challenge.chgStartDt,  challenge.chgEndDt, challenge.challengeCreateDt FROM challenge WHERE challenge.licenseId IS NULL AND concat(challenge.challengeTitle, challenge.challengeIntroduction) regexp ? UNION SELECT challenge.challengeId, challenge.challengeTitle, license.licenseName, challenge.challengeIntroduction, challenge.proofCount, challenge.proofCountOneDay, challenge.challengeTitleImage, challenge.deposit , challenge.chgStartDt,  challenge.chgEndDt, challenge.challengeCreateDt FROM challenge, license WHERE challenge.licenseId=license.licenseId AND concat(challenge.challengeTitle, license.licenseName, challenge.challengeIntroduction) regexp ? ORDER BY challengeCreateDt DESC LIMIT "
export const getAchievementRate = "SELECT challenge.challengeId, challenge.challengeTitle, join_challenge.successCnt, join_challenge.failCnt, IFNULL(ROUND((join_challenge.successCnt/(join_challenge.successCnt+join_challenge.failCnt))*100),0) AS achievement_rate FROM challenge, join_challenge WHERE join_challenge.challengeId = challenge.challengeId AND join_challenge.userId=? AND challenge.challengeId=?"
export const enterChallenge_leader = "INSERT INTO join_challenge(challengeId, userId, successCnt, failCnt, pass) VALUES (?,?,0,0,0)"
export const enterChallenge_follower = "INSERT INTO join_challenge(challengeId, userId, successCnt, failCnt, pass) VALUES (?,?,0,0,0);" 
export const plusJoinPeople = "UPDATE challenge SET joinPeople = joinPeople+1 WHERE challengeId = ?;"

export const getChallengeEndDt = "SELECT chgEndDt FROM challenge WHERE challengeId=?"
export const checkDepositRefund = "SELECT pass, refund_deposit, achievement_rate, ( CASE WHEN 80 <= achievement_rate THEN 100 WHEN  50 <= achievement_rate AND achievement_rate < 80 THEN achievement_rate WHEN achievement_rate < 50 THEN 0 ELSE -1 END ) AS refund_rate FROM join_challenge, (SELECT IFNULL(ROUND((join_challenge.successCnt/(join_challenge.successCnt+join_challenge.failCnt))*100),0) AS achievement_rate FROM join_challenge WHERE userId = ? AND challengeId = ?) B WHERE userId = ? AND challengeId = ?"
export const successDepositRefund = "UPDATE join_challenge SET refund_deposit = 1 WHERE challengeId = ? AND userId = ?"